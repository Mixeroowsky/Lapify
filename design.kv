#:kivy 1.11.1
#:import NoTransition kivy.uix.screenmanager.NoTransition
#:import hex kivy.utils.get_color_from_hex
#:import utils kivy.utils
#:import Factory kivy.factory.Factory
Manager:
	transition: NoTransition()
    NowaSesja:
    Rozpocznij:
    NowyKierowca:
    WybierzKierowce:
    DodajKierowce:
    Live:
    PoprzednieSesje:
    HistoriaWyscigu:
    Pomoc:
    Refresh:


################################################################################################
<OrangeLabel@Label>
    font_name: 'graphics/Roboto-Light'
    font_size: '20'
    color: 1,.5,0,1

################################################################################################
<Button>:          # Pomarańczowe guziczki
    background_down: 'graphics/pressed.png'

################################################################################################
<ImageButton@Button>:
	background_normal: 'graphics/titlebar.png'
	background_down: 'graphics/pressed.png'
	size_hint: (None,None)
	size: 120,40
	color: 0,0,0,1
	font_name: 'graphics/Roboto-Light'
	font_size: '14'


################################################################################################
<NowaSesja>:
    name: "nowa"
    on_pre_enter: tabelaOstatniaSesja.clear_widgets()    # Czyścimy tabele
    on_enter: root.generujtabele()    # Wyświetlamy zaktualizowaną

    canvas:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    StackLayout:
	    canvas:
		    Color:
			    rgba: (1,1,1,1)
		    Rectangle:
			    source: 'graphics/titlebar.png'
			    pos: 0, self.height-40
			    size: self.width, 40

        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: root.text1
            on_release:
                app.root.current = "nowa"
        ImageButton:
            text: "Live"
            on_release:
                app.root.current = "live"
        ImageButton:
            text: "Poprzednie Sesje"
            on_release:
                app.root.current = "poprzednie"
        ImageButton:
            text: "Pomoc"
            on_release:
                app.root.current = "pomocy"

        FloatLayout:
            Image:
                source: 'graphics/lapify.png'
                size_hint: None, None
                pos: root.width-(self.width+200),root.height-160
                size: 120,120
            Image:
                source: 'graphics/gllogo.png'
                size_hint: None, None
                pos: root.width-self.width+20,root.height-230
                size:250,250


            Button:
                background_color: hex('#FFFFFF')
                pos_hint:{"x":0.68,"top":0.55}
                size_hint: 0.22, 0.1
                text: root.text2
                on_release:
                    root.fade()     # Żeby fade był tylko przy okienku Rozpocznij
                    app.root.current = "rozpocznij"
                    root.unfade()

            Button:
                background_color: hex('#FFFFFF')
                pos_hint:{"x":0.68,"top":0.4}
                size_hint: 0.22, 0.1
                text: "Koniec"
                on_release:
                    app.stop() 	  # Wychodzenie z apki przyciskiem
	        Label:
	        	size_hint: (None,None)
	            pos_hint: {"x":0.06,"y":0.89}
	            font_size: '30'
	            text: "Ostatnia sesja:"
	            color: hex('#EF8B00')

            FloatLayout:
                id: p_ostatnia_sesja

                GridLayout:      # Ciemna obwódka wokół tabeli
                    cols: 1
                    size_hint: (None,None)
                    size: (734,504.5)
                    pos_hint:{"x":0.0185,"y":0.1}
                    canvas:
                        Color:
                            rgba: hex('#404040')
                        Rectangle:
                            pos: self.pos
                            size: self.size

                StackLayout:      # Tabela
                    id: tabelaOstatniaSesja
                    orientation: 'lr-tb'
                    spacing: [1,1]
                    size_hint: (None,None)
                    size: (730,500)
                    pos_hint:{"x":0.02,"y":0.103}
                    canvas:
                        Color:
                            rgba: hex('#606060')
                        Rectangle:
                            pos: self.pos
                            size: self.size

################################################################################################
<PoprzednieSesje>:
    name: "poprzednie"
    on_enter:
        tabelaPoprzednie.clear_widgets()    # Czyścimy tabele
        root.generuj()    # Wyświetlamy zaktualizowaną
    canvas:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    FloatLayout:
        Image:
            source: 'graphics/lapify.png'
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:
	    canvas:
		    Color:
			    rgba: (1,1,1,1)
		    Rectangle:
			    source: 'graphics/titlebar.png'
			    pos: 0, self.height-40
			    size: self.width, 40

        ImageButton:
            text: root.text1
            on_release:
                app.root.current = "nowa"
        ImageButton:
            text: "Live"
            on_release:
                app.root.current = "live"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Poprzednie Sesje"
            on_release:
                app.root.current = "poprzednie"
        ImageButton:
            text: "Pomoc"
            on_release:
                app.root.current = "pomocy"
    FloatLayout:    #czarna ramka wokół okienka

	    FloatLayout:
	        id: oknoPoprzednie

            GridLayout:      # Ciemna obwódka wokół tabeli
                cols: 1
                size_hint: (None,None)
                size: (734,504.5)
                pos_hint:{"x":0.0185,"y":0.167}
                canvas:
                    Color:
                        rgba: hex('#404040')
                    Rectangle:
                        pos: self.pos
                        size: self.size

            StackLayout:      # Tabela
                id: tabelaPoprzednie
                orientation: 'lr-tb'
                spacing: [1,1]
                size_hint: (None,None)
                size: (730,500)
                pos_hint:{"x":0.02,"y":0.17}
                canvas:
                    Color:
                        rgba: hex('#606060')
                    Rectangle:
                        pos: self.pos
                        size: self.size

    #FloatLayout:    #okienko
	 #   canvas:
	#	    Color:
	#		    rgba: hex('#808080')
	#	    Rectangle:
	#		    pos: root.width-self.width+20,root.height-650
	#		    size: 930,550
	 #   Label:
      #      text: 'Historia wyscigow:'
       #     color: hex('#EF8B00')
         #   pos: -490,290
        #    font_size: '30'

######################################################
<Live>:
    name: "live"
    on_pre_enter: tabelaLive.clear_widgets()    # Czyścimy tabele
    on_enter: root.generuj()    # Wyświetlamy zaktualizowaną

    canvas:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size

    FloatLayout:

        Image:
            source: 'graphics/lapify.png'
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:
	    canvas:
		    Color:
			    rgba: (1,1,1,1)
		    Rectangle:
			    source: 'graphics/titlebar.png'
			    pos: 0, self.height-40
			    size: self.width, 40

        ImageButton:
            text: root.text1
            on_release:
                app.root.current = "nowa"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Live"
            on_release:
                app.root.current = "live"
        ImageButton:
            text: "Poprzednie Sesje"
            on_release:
                app.root.current = "poprzednie"
        ImageButton:
            text: "Pomoc"
            on_release:
                app.root.current = "pomocy"

        FloatLayout:
            id: plansza

            TextInput:
                id: czas
                multiline: False
                pos_hint: {"x":0.75,"y":0.6}
                size_hint: (None,None)
                size: (100,50)
            Button:
                pos_hint:{"x":0.75,"y":0.5}
                size_hint: (None,None)
                size: (100,50)
                text: "REFRESH"
                on_release:
                    app.root.current = "refresh"
                    app.root.current = "live"

            GridLayout:      # Ciemna obwódka wokół tabeli
                cols: 1
                size_hint: (None,None)
                size: (734,504.5)
                pos_hint:{"x":0.0185,"y":0.167}
                canvas:
                    Color:
                        rgba: hex('#404040')
                    Rectangle:
                        pos: self.pos
                        size: self.size

            StackLayout:      # Tabela
                id: tabelaLive
                orientation: 'lr-tb'
                spacing: [1,1]
                size_hint: (None,None)
                size: (730,500)
                pos_hint:{"x":0.02,"y":0.17}
                canvas:
                    Color:
                        rgba: hex('#606060')
                    Rectangle:
                        pos: self.pos
                        size: self.size

######################################################
<Pomoc>:
    name: "pomocy"
    canvas:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    FloatLayout:
        Image:
            source: 'graphics/lapify.png'
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:
	    canvas:
		    Color:
			    rgba: (1,1,1,1)
		    Rectangle:
			    source: 'graphics/titlebar.png'
			    pos: 0, self.height-40
			    size: self.width, 40

        ImageButton:
            text: root.text1
            on_release:
                app.root.current = "nowa"
        ImageButton:
            text: "Live"
            on_release:
                app.root.current = "live"
        ImageButton:
            text: "Poprzednie Sesje"
            on_release:
                app.root.current = "poprzednie"
        ImageButton:
            text: "Pomoc"
            on_release:
                app.root.current = "pomocy"
######################################################
#   zawartosc karty pomoc
######################################################
        BoxLayout:
            BoxLayout:
                orientation: 'vertical'
                Label:
                    size_hint_y: .2
                OrangeLabel:
                    text: root.text2
                    size_hint_y: .2
                OrangeLabel:
                    size_hint_y: .3
                    text: "info@globallogic.com"
                    font_size: '32'
                Label:
            BoxLayout:
                orientation: 'vertical'
                Label:
                    size_hint_y: .2
                OrangeLabel:
                    text: "Lapify v0.0.1"
                    font_size: '32'
                    size_hint_y: 0.1
                OrangeLabel:
                    text: "Dla Global Logic S. A."
                    size_hint_y: 0.1
                    font_size: '32'
                Label:

            BoxLayout:
                orientation: 'vertical'
                Label:
                    size_hint_y: .5
                OrangeLabel:
                    text: "Autorzy: "
                    size_hint_y: .1
                OrangeLabel:
                    text: root.text3
                    size_hint_y: .1
                OrangeLabel:
                    text: "Piotr Janicki"
                    size_hint_y: .1
                OrangeLabel:
                    text: "Aleksandra Kaczmarska"
                    size_hint_y: .1
                OrangeLabel:
                    text: root.text4
                    size_hint_y: .1
                OrangeLabel:
                    text: root.text5
                    size_hint_y: .1
                Label:

######################################################
<DodajKierowce>:
    name: "dodaj"
    canvas.before:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    canvas:
        Color:
            rgba: (0,0,0,.3)
        Rectangle:
            size:self.width, self.height
    FloatLayout:
        Image:
            source: 'graphics/lapify.png'
            color: (1,1,1,.5)
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:    #przyciemniony górny pasek
        canvas:
            Color:
                rgba: (1,1,1,1)
            Rectangle:
                source: 'graphics/pressed.png'
                pos: 0, self.height-40
                size: self.width, 40
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: root.text1
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Live"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Poprzednie Sesje"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Pomoc"
    FloatLayout:    #czarna ramka wokół okienka
	    canvas:
		    Color:
			    rgba: hex('#000000')
		    Rectangle:
			    pos: 173,73
			    size: 934,554
    FloatLayout:    #okienko
	    canvas:
		    Color:
			    rgba: hex('#808080')
		    Rectangle:
			    pos: 175,75
			    size: 930,550

	    FloatLayout:
	        Label:
	        	size_hint: (None,None)
	            pos_hint: {"x":0.23,"y":0.76}
	            font_size: '24'
	            text: root.text2
	            color: hex('#000000')
            BoxLayout:
                orientation: 'horizontal'
                size_hint: (0.65, 0.5) #rozmiar ciemnoszarego tla
                pos_hint:{"x":0.17,"y":0.2}
                canvas:
                    Color:
                        rgba: hex('#404040')
                    Rectangle:
                        pos: self.pos
                        size: self.size
                FloatLayout:
                    BoxLayout:
                        orientation: 'vertical'
                        size_hint_x: .8
                        pos_hint: {"center_x":.5,'y': 1} #pozycja labelow i inputow
                        BoxLayout:
                            size_hint_y: None
                            height: 50

                            Label:
                                text: root.text3
                                size_hint_x: .4
                            Label:
                                text: 'Nazwisko'
                                size_hint_x: .4

                            Label:
                                text: 'Model'
                                size_hint_x: .4
                            Label:
                                text: 'Kategoria'
                                size_hint_x: .4
                            Label:
                                text: 'RFID'
                                size_hint_x: .4



                            Label:
                                text: ''
                                size_hint_x: .2
                        BoxLayout:
                            id: input
                            size_hint_y: None
                            pos_hint_x: 1
                            height: 30

                            TextInput:
                                id: name
                                multiline: False
                                size_hint_x: .3
                            TextInput:
                                id: last_name
                                multiline: False
                                size_hint_x: .3

                            TextInput:
                                id: model
                                multiline: False
                                size_hint_x: .3
                            TextInput:
                                id: category
                                multiline: False
                                size_hint_x: .3
                            TextInput:
                                id: tag
                                multiline: False
                                size_hint_x: .3

                            Button:
                                id:add
                                text: 'Dodaj'
                                on_release: root.add_driver()
                                size_hint_x: .2
                    GridLayout:
                        pos_hint: {'center_x':0.55, 'top': 1}
                        size_hint_x: 1
                        size_hint_y: None
                        size:
                        id:list
                        cols: 1
            Button:
                size_hint: 0.1, 0.05
                pos_hint:{"center_x":0.5,"y":0.13}
                text: 'Ok'
                on_release:
                    app.root.current = "rozpocznij"


######################################################
<Rozpocznij>:
    name: "rozpocznij"
    canvas.before:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    canvas:
        Color:
            rgba: (0,0,0,.3)
        Rectangle:
            size:self.width, self.height
    FloatLayout:
        Image:
            source: 'graphics/lapify.png'
            color: (1,1,1,.5)
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:    #przyciemniony górny pasek
        canvas:
            Color:
                rgba: (1,1,1,1)
            Rectangle:
                source: 'graphics/pressed.png'
                pos: 0, self.height-40
                size: self.width, 40
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: root.text1
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Live"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Poprzednie Sesje"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Pomoc"
    FloatLayout:    #czarna ramka wokół okienka
	    canvas:
		    Color:
			    rgba: hex('#000000')
		    Rectangle:
			    pos: 173,73
			    size: 934,554
    FloatLayout:    #okienko
	    canvas:
		    Color:
			    rgba: hex('#808080')
		    Rectangle:
			    pos: 175,75
			    size: 930,550
	    FloatLayout:
	        Label:
	        	size_hint: (None,None)
	            pos_hint: {"x":0.18,"y":0.76}
	            font_size: '24'
	            text: "Nowa sesja"
	            color: hex('#000000')
	        Label:
	        	size_hint: (None,None)
	            pos_hint: {"x":0.18,"y":0.69}
	            font_size: '18'
	            text: root.text2
	            color: hex('#000000')
	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.56,"y":0.732}
	            size: 40,40
	            text: "OK"
	            on_release: root.input()
	        TextInput:
	            id: wyscig
	            size_hint: (None,None)
	            size: 300,36
	            font_size: '18'
	            pos_hint: {"x":0.28,"y":0.732}
	            multiline: False
            BoxLayout:
                orientation: 'horizontal'
                size_hint: (None,None)
                size: (570,320)
                pos_hint:{"x":0.17,"y":0.25}
                canvas:
                    Color:
                        rgba: hex('#404040')
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation: 'vertical'
                    size_hint: (None,None)
                    size: (190,320)
                    canvas:
                        Color:
                            rgba: hex('#404040')
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text: "ID Kierowcy"
                        canvas.before:
                            Color:
                                rgba: hex('#303030')
                            Rectangle:
                                size: self.size
                                pos: self.pos
                    Label:
                        text: "01"
                    Label:
                        text: "02"
                    Label:
                        text: "03"
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                BoxLayout:
                    orientation: 'vertical'
                    size_hint: (None,None)
                    size: (190,320)
                    canvas:
                        Color:
                            rgba: hex('#404040')
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text: "Imie"
                        canvas.before:
                            Color:
                                rgba: hex('#303030')
                            Rectangle:
                                size: self.size
                                pos: self.pos
                    Label:
                        text: "Andrzej"
                    Label:
                        text: "Monika"
                    Label:
                        text: "Krystian"
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                BoxLayout:
                    orientation: 'vertical'
                    size_hint: (None,None)
                    size: (190,320)
                    canvas:
                        Color:
                            rgba: hex('#404040')
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text: "Nazwisko"
                        canvas.before:
                            Color:
                                rgba: hex('#303030')
                            Rectangle:
                                size: self.size
                                pos: self.pos
                    Label:
                        text: "Motyka"
                    Label:
                        text: "Kielbasa"
                    Label:
                        text: "Nowak"
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""
                    Label:
                        text: ""

	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.18,"y":0.15}
	            size: 110,40
	            text: "Cofnij"
	            on_release:
	                root.fade()
	                app.root.current = "nowa"
	                root.unfade()
	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.7,"y":0.15}
	            size: 110,40
	            text: "Dalej"
	            on_release:
                    root.swap()     #fajne przejście

	                app.root.current = "live"
                    root.unswap()   #powrót do normalnego
	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.3,"y":0.15}
	            size: 130,40
	            text: root.text3
                on_release:
                    app.root.current = "dodaj"
	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.405,"y":0.15}
	            size: 130,40
	            text: root.text4
	        Button:
	            background_color: hex('#FFFFFF')
	            size_hint: (None,None)
	            pos_hint: {"x":0.51,"y":0.15}
	            size: 130,40
	            text: root.text5


################################################################################################
<HistoriaWyscigu>:
    name:"historia"
    on_enter:
        tabelaHistoria.clear_widgets()    # Czyścimy tabele
        root.generuj()    # Wyświetlamy zaktualizowaną

    canvas.before:
        Color:
	        rgba: hex('#6F696D')
	    Rectangle:
	        pos: self.pos
	        size: self.size
    canvas:
        Color:
            rgba: (0,0,0,.3)
        Rectangle:
            size:self.width, self.height
    FloatLayout:
        Image:
            source: 'graphics/lapify.png'
            color: (1,1,1,.5)
            size_hint: None, None
            pos: root.width-(self.width+200),root.height-160
            size: 120,120
        Image:
            source: 'graphics/gllogo.png'
            size_hint: None, None
            pos: root.width-self.width+20,root.height-230
            size:250,250
    StackLayout:    #przyciemniony górny pasek
        canvas:
            Color:
                rgba: (1,1,1,1)
            Rectangle:
                source: 'graphics/pressed.png'
                pos: 0, self.height-40
                size: self.width, 40
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: root.text1
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Live"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Poprzednie Sesje"
        ImageButton:
            background_normal: 'graphics/pressed.png'
            text: "Pomoc"
    FloatLayout:    #czarna ramka wokół okienka
	    canvas:
		    Color:
			    rgba: hex('#000000')
		    Rectangle:
			    pos: 173,73
			    size: 934,554
    FloatLayout:    #okienko
	    canvas:
		    Color:
			    rgba: hex('#808080')
		    Rectangle:
			    pos: 175,75
			    size: 930,550

	    FloatLayout:
	        id: oknoHistoria

            GridLayout:      # Ciemna obwódka wokół tabeli
                cols: 1
                size_hint: (None,None)
                size: (654,394.5)
                pos_hint:{"x":0.2382,"y":0.1965}
                canvas:
                    Color:
                        rgba: hex('#606060')
                    Rectangle:
                        pos: self.pos
                        size: self.size

            StackLayout:
                id: tabelaHistoria
                orientation: 'lr-tb'
                spacing: [1,1]
                size_hint: (None,None)
                size: (650,390)
                pos_hint:{"x":0.24,"y":0.2}
                canvas:
                    Color:
                        rgba: hex('#707070')
                    Rectangle:
                        pos: self.pos
                        size: self.size

            Button:
                size_hint: 0.1, 0.05
                pos_hint:{"center_x":0.5,"y":0.13}
                text: root.text2
                on_release:
                    app.root.current = "poprzednie"
######################################################
<Refresh>:
    name: "refresh"

    canvas:
        Color:
	        rgba: hex('#000000')
	    Rectangle:
	        pos: self.pos
	        size: self.size

